### README

## Обзор проекта

Этот проект включает создание Telegram-бота для анализа японских СМИ, который помогает пользователям, предоставляя информацию на основе предобученной модели и дополнительных контекстных данных, хранящихся в JSON-файлах. Бот взаимодействует с пользователями, обрабатывает их запросы и предоставляет ответы на основе указанного года. Проект включает очистку и подготовку данных JSON, интеграцию с Yandex GPT и Yandex Translate API, дообучение Yandex GPT, разработку алгоритмов для более качественного перевода, а также управление взаимодействиями через Telegram-бота.

### Структура проекта

```
.
├── config.json
├── app.py
├── requirements.txt
├── data
│   ├── cleaning_data.py
│   └── train2019.json

```

### Подготовка данных

Мы получили данные в формате WARC файлов. Это были тексты новостей в необработанном формате HTML, не очищенном от рекламы, регулярно повторяющихся ссылок, анонсов, и проч. текстов, обрамляющих собственно новостной текст. В датасете встречались дубли одной новости на разных сайтах, возможно, в немного измененном виде. 

Мы очищали датасет следующими методами: 

### Основные этапы работы с данными:

1. **Очистка HTML контента и извлечение ссылок:**
   - Мы извлекли файлы с помощью библиотеки **warcio**. Затем использовали библиотеку  **BeautifulSoup** парсинга и очистки HTML контента. Мы удалили скрипты, стили, комментарии, рекламные блоки и другие ненужные элементы, чтобы извлечь только полезную текстовую информацию.
   - Также мы извлекли все ссылки, найденные в HTML контенте. Это позволило нам сохранять контекст и источники информации.

2. **Нормализация текста:**
   - Мы использовали библиотеку **unicodedata** для нормализовали текста. С помощью функции `unicodedata.normalize` мы привели датасет к единообразному виду и упростили дальнейшую обработку.

3. **Очистка текста от повторяющихся ссылок и лишних пробелов:**
   - Мы удалили повторяющиеся ссылки и лишние пробелы, чтобы текст был более читаемым и компактным. Это также помогло избежать дублирования информации при дальнейшем анализе. Также, использовали библиотеку - **re** для работы с регулярными выражениями.

4. **Удаление ссылок на изображения:**
   - Мы удалили ссылки на изображения, так как они не несут полезной текстовой информации для нашего анализа.

Код работы с датасетом Вы можете посмотреть в 
   ```sh
data/cleaning_data.py
   ```
Часть датасета для обучения Yandex GPT доступна в 
  ```sh
data/train2019.json
   ```

Полный очищенный датасет в формате .JSON Вы можете найти на Яндекс Диске по адресу https://disk.yandex.ru/d/JIXB7DPbTNygqg

### Техническая реализация

1. **Инициализация Telegram-бота:**
   - Для создания, настройки и подключения чат- бота мы использовали библиотеку `python-telegram-bot`.
   - 
2. **Обработка запросов пользователей:**
   - Мы добавили возможность для пользователя выбирать год данных через кнопки, предоставляемые ботом:
     
    ```sh
    до 2019 года
    до конца 2019 года
    до конца 2022 года
    до конца 2023 года
       ```
     
   - Далее, запросы пользователей переводятся на японский язык с помощью Yandex Translate API.
   - Переведенный запрос и контекст из соответствующих JSON-файлов отправляются в дообученную Yandex GPT для получения ответа.

3. **Поиск ответов в JSON-файлах:**
   - JSON-файлы хранятся в папках, соответствующих годам данных.
   - В зависимости от выбранного пользователем года, производится поиск ответов в соответствующих папках.

4. **Перевод и форматирование ответов:**
   - Полученные ответы переводятся обратно на русский язык с помощь Yandex Translate. Спецмиальные алгоритмы позволяют сохраненять написание японских имен собственных на оригинале.
   - Также, мы добавили форматирование ответа с добавлением ссылок на дополнительные материалы.

5. **Отправка ответа пользователю:**
   - Отформатированный ответ отправляется пользователю через Telegram-бота.


### Установка и запуск проекта

1. Клонируйте репозиторий проекта:

   ```sh
   https://github.com/Enc0der/CAIts.git
   cd project
   ```

2. Создайте и активируйте виртуальное окружение:

   ```sh
   python3 -m venv venv
   source venv/bin/activate
   ```

3. Установите зависимости:

   ```sh
   pip install -r requirements.txt
   ```

4. Настройте файл `config.json` с вашими ключами API и другими необходимыми параметрами.

5. Запустите бота:

   ```sh
   python app.py
   ```

Теперь ваш Telegram-бот готов к использованию. Вы можете взаимодействовать с ним через Telegram, отправляя запросы и получая информацию на основе данных из JSON-файлов.

   ```sh
Приятного пользования!
   ```
