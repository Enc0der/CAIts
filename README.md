### README

## Обзор проекта

Этот проект включает создание Telegram-бота для анализа японских СМИ, который помогает пользователям, предоставляя информацию на основе предобученной модели и дополнительных контекстных данных, хранящихся в JSON-файлах. Бот взаимодействует с пользователями, обрабатывает их запросы и предоставляет ответы на основе указанного года. Проект включает очистку и подготовку данных JSON, интеграцию с Yandex GPT и Yandex Translate API, а также управление взаимодействиями через Telegram-бота.

### Структура проекта

```
.
├── config.json
├── app.py
├── requirements.txt
├── cleaning_data.py
├── cleaned_json/
│   ├── до_2019/
│   │   ├── file1.json
│   │   └── file2.json
│   ├── 2019/
│   │   ├── file1.json
│   │   └── file2.json
│   ├── до_2022/
│   │   ├── file1.json
│   │   └── file2.json
│   ├── до_2023/
│   │   ├── file1.json
│   │   └── file2.json
```

### Подготовка данных

### Описание скрипта

Этот скрипт предназначен для очистки HTML контента из WARC файлов, извлечения текстовой информации и ссылок, а также сохранения очищенных данных в текстовые файлы. Он был разработан для подготовки данных, которые затем могут быть использованы в проекте для обработки и предоставления ответов через Telegram-бота.

### Основные этапы работы скрипта

1. **Загрузка конфигурации:**
   - Мы загружаем конфигурационные параметры из файла `config.json`, включая пути к базовой и целевой директориям. Это позволяет легко настраивать скрипт для работы с различными наборами данных и окружениями.

2. **Очистка HTML контента и извлечение ссылок:**
   - Мы используем библиотеку BeautifulSoup для очистки HTML контента. Мы удаляем скрипты, стили, комментарии, рекламные блоки и другие ненужные элементы, чтобы извлечь только полезную текстовую информацию.
   - Также мы извлекаем все ссылки, найденные в HTML контенте. Это позволяет нам сохранять контекст и источники информации.

3. **Генерация имени файла:**
   - Для каждого URL мы генерируем уникальное имя файла, чтобы избежать конфликтов и слишком длинных имен файлов. Если имя файла превышает допустимую длину, мы используем хэширование с добавлением индекса для сокращения и уникализации имени.

4. **Нормализация текста:**
   - Мы нормализуем текст с помощью функции `unicodedata.normalize`, чтобы привести его к единообразному виду и упростить дальнейшую обработку.

5. **Очистка текста от повторяющихся ссылок и лишних пробелов:**
   - Мы удаляем повторяющиеся ссылки и лишние пробелы, чтобы текст был более читаемым и компактным. Это также помогает избежать дублирования информации при дальнейшем анализе.

6. **Удаление ссылок на изображения:**
   - Мы удаляем ссылки на изображения, так как они не несут полезной текстовой информации для нашего анализа.

7. **Обработка и сохранение данных:**
   - Мы обрабатываем все файлы в базовой директории, извлекая и очищая данные из каждого WARC файла.
   - Очищенные данные сохраняются в целевой директории в виде текстовых файлов. Мы также сохраняем все извлеченные ссылки, чтобы можно было легко найти источник информации.


### Библиотеки и технологии

Мы использовали следующие библиотеки и технологии для реализации скрипта:
- **os**: Для работы с файловой системой.
- **hashlib**: Для генерации хэшей и уникальных имен файлов.
- **json**: Для работы с конфигурационными файлами и данными.
- **BeautifulSoup**: Для парсинга и очистки HTML контента.
- **unicodedata**: Для нормализации текста.
- **warcio**: Для чтения WARC файлов.
- **re**: Для работы с регулярными выражениями.
- **shutil**: Для работы с файловой системой (создание директорий, копирование файлов и т.д.).

### Преимущества подхода

Наш подход к очистке данных и извлечению информации из HTML контента позволяет существенно улучшить качество данных, используемых для обработки запросов на японском языке. Очистка от лишних элементов и нормализация текста делает данные более структурированными и удобными для анализа, что повышает точность и релевантность ответов, предоставляемых нашим Telegram-ботом. 

Код работы с датасетом Вы можете посмотреть в cleaning_data.py

### Установка и запуск

Для установки всех необходимых библиотек и зависимостей используйте следующий файл `requirements.txt`:


Теперь ваш скрипт готов к использованию. Вы можете очищать данные и использовать их для дальнейшего анализа и обработки запросов через Telegram-бота.
### Техническая реализация

1. **Инициализация Telegram-бота:**
   - Использование библиотеки `python-telegram-bot` для создания и настройки бота.
   - Настройка обработчиков команд и сообщений для взаимодействия с пользователями.

2. **Обработка запросов пользователей:**
   - Пользователь выбирает год данных через кнопки, предоставляемые ботом.
   - Запросы пользователей переводятся на японский язык с помощью Yandex Translate API.
   - Переведенный запрос и контекст из соответствующих JSON-файлов отправляются в Yandex GPT для получения ответа.

3. **Поиск ответов в JSON-файлах:**
   - JSON-файлы хранятся в папках, соответствующих годам данных.
   - В зависимости от выбранного пользователем года, производится поиск ответов в соответствующих папках.
   - Ответы ограничиваются пятью предложениями и сохраняются в файл для последующего использования.

4. **Перевод и форматирование ответов:**
   - Полученные ответы переводятся обратно на русский язык с сохранением имен собственных.
   - Форматирование ответа с добавлением ссылок на дополнительные материалы.

5. **Отправка ответа пользователю:**
   - Отформатированный ответ отправляется пользователю через Telegram-бота.

### Файл requirements.txt

Для установки всех необходимых библиотек и зависимостей используйте следующий файл `requirements.txt`:

### Установка и запуск проекта

1. Клонируйте репозиторий проекта:

   ```sh
   git clone https://github.com/your-repo/project.git
   cd project
   ```

2. Создайте и активируйте виртуальное окружение:

   ```sh
   python3 -m venv venv
   source venv/bin/activate
   ```

3. Установите зависимости:

   ```sh
   pip install -r requirements.txt
   ```

4. Настройте файл `config.json` с вашими ключами API и другими необходимыми параметрами.

5. Запустите бота:

   ```sh
   python main.py
   ```

Теперь ваш Telegram-бот готов к использованию. Вы можете взаимодействовать с ним через Telegram, отправляя запросы и получая информацию на основе данных из JSON-файлов.
